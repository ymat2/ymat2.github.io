[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "ビルドフレームワークの移行 (hugo -&gt; quarto) に伴い、 一時的にサイトのコンテンツを非公開にしています。\n\n\n松田 優樹 (MATSUDA Yuki)\n\n東北大学 大学院 生命科学研究科 分子化学生物学専攻 進化ゲノミクス分野 \n\nContacts\n\nyuki.matsuda.m10あっとgmail.com\n\n\nyuki.matsuda.r7あっとdc.tohoku.ac.jp\n\nLinks\n\n  ymat2 \n\n\n  0009-0006-2288-1621",
    "crumbs": [
      "HOME"
    ]
  },
  {
    "objectID": "bio/paml-tutorial.html",
    "href": "bio/paml-tutorial.html",
    "title": "PAML チュートリアル",
    "section": "",
    "text": "PAML のテストデータを材料に codeml を一通り動かしてみる。\nPhylogenetic Analysis by Maximum Likelihood (PAML) は、DNA やタンパク質の配列を最尤法で系統解析するための 種々のプログラムを含むパッケージ。\n今回はその中で、コドンの配列から同義置換に対する非同義置換の速度である \\(\\omega = d_\\text{N} / d_\\text{S}\\) を推定して正の自然選択の検出を行う codeml を使う。",
    "crumbs": [
      "Bioinformatics",
      "PAML チュートリアル"
    ]
  },
  {
    "objectID": "bio/paml-tutorial.html#テストデータの準備",
    "href": "bio/paml-tutorial.html#テストデータの準備",
    "title": "PAML チュートリアル",
    "section": "テストデータの準備",
    "text": "テストデータの準備\nPAML の方で用意してある リゾチームの配列 を使う。んだけど、ファイルフォーマットが普段牧野研でよく使う形式と異なるので、 ひとまず↓をコピペして使ってください。\n\n\nlysozymeSmall.fa\n\n&gt;Hsa_Human\nAAGGTCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAGATTGGGAATGGATGGCTAC\nAGGGGAATCAGCCTAGCAAACTGGATGTGTTTGGCCAAATGGGAGAGTGGTTACAACACA\nCGAGCTACAAACTACAATGCTGGAGACAGAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCGCTACTGGTGTAATGATGGCAAAACCCCAGGAGCAGTTAATGCCTGTCATTTATCC\nTGCAGTGCTTTGCTGCAAGATAACATCGCTGATGCTGTAGCTTGTGCAAAGAGGGTTGTC\nCGTGATCCACAAGGCATTAGAGCATGGGTGGCATGGAGAAATCGTTGTCAAAACAGAGAT\nGTCCGTCAGTATGTTCAAGGTTGTGGAGTG\n\n&gt;Hla_gibbon\nAAGGTCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAGATTGGGAATGGATGGCTAC\nAGGGGAATCAGCCTAGCAAACTGGATGTGTTTGGCCAAATGGGAGAGTGGTTATAACACA\nCGAGCTACAAACTACAATCCTGGAGACAGAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCGCTACTGGTGTAATGATGGCAAAACCCCAGGAGCAGTTAATGCCTGTCATTTATCC\nTGCAATGCTTTGCTGCAAGATAACATCGCCGATGCTGTAGCTTGTGCAAAGAGGGTTGTC\nCGCGATCCACAAGGCATTAGAGCATGGGTGGCATGGAGAAATCGTTGTCAAAACAGAGAT\nCTCCGTCAGTATATTCAAGGTTGTGGAGTA\n\n&gt;Cgu/Can_colobus\nAAGATCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAAATTGGGACTGGATGGCTAC\nAAGGGAGTCAGCCTAGCAAACTGGGTGTGTTTGGCCAAATGGGAGAGTGGTTATAACACA\nGACGCTACAAACTACAATCCTGGAGATGAAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCGCTACTGGTGTAATAATGGCAAAACCCCAGGAGCAGTTAATGCCTGTCATATATCC\nTGCAATGCTTTGCTGCAAAATAACATCGCTGATGCTGTAGCTTGTGCAAAGAGGGTTGTC\nAGTGATCCACAAGGCATTCGAGCATGGGTGGCATGGAAAAAGCACTGTCAAAACAGAGAT\nGTCAGTCAGTATGTTGAAGGTTGTGGAGTA\n\n&gt;Pne_langur\nAAGATCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAAATTGGGACTGGATGGCTAC\nAAGGGAGTCAGCCTAGCAAACTGGGTGTGTTTGGCCAAATGGGAGAGTGGTTATAACACA\nGAAGCTACAAACTACAATCCTGGAGACGAAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCGCTACTGGTGTAATAATGGCAAAACCCCAGGAGCAGTTGATGCCTGTCATATATCC\nTGCAGTGCTTTGCTGCAAAACAACATCGCTGATGCTGTAGCTTGTGCAAAGAGGGTTGTC\nAGTGATCCACAAGGCGTTCGAGCATGGGTGGCATGGAGAAATCACTGTCAAAACAAAGAT\nGTCAGTCAGTACGTTAAAGGTTGTGGAGTG\n\n&gt;Mmu_rhesus\nAAGATCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAGATTGGGACTGGATGGCTAC\nAGGGGAATCAGCCTAGCAAACTGGGTGTGTTTGGCCAAATGGGAGAGTAATTATAACACA\nCAAGCTACAAACTACAATCCTGGAGACCAAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCACTACTGGTGTAATAATGGCAAAACCCCAGGAGCAGTTAATGCCTGTCATATATCC\nTGCAATGCTTTGCTGCAAGATAACATCGCTGATGCTGTAACTTGTGCAAAGAGGGTTGTC\nAGTGATCCACAAGGCATTAGAGCATGGGTGGCATGGAGAAATCACTGTCAAAACAGAGAT\nGTCAGTCAGTATGTTCAAGGTTGTGGAGTG\n\n&gt;Ssc_squirrelM\nAAGGTCTTCGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAGGCTTGGAATGGATGGCTAC\nAGGGGAATCAGCCTAGCAAACTGGATGTGTTTGGCCAAATGGGAGAGTGACTATAACACA\nCGTGCTACAAACTACAATCCTGGAGACCAAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCACTATTGGTGTAATAATGGCAGAACCCCAGGAGCAGTTAATGCCTGTCATATATCC\nTGCAATGCTTTGCTGCAAGATGACATCACTCAAGCTGTGGCCTGTGCAAAGAGGGTTGTC\nCGTGATCCACAAGGCATTAGAGCATGGGTGGCATGGAAAGCTCATTGTCAAAACAGAGAT\nGTCAGTCAGTATGTTCAAGGTTGTGGAGTA\n\n&gt;Cja_marmoset\nAAGGTCTTTGAAAGGTGTGAGTTGGCCAGAACTCTGAAAAGGTTTGGACTGGATGGCTAC\nAGGGGAATCAGCCTAGCAAACTGGATGTGTTTGGCCAAATGGGAGAGTGATTATAACACA\nCGTGCTACAAACTACAATCCTGGAGACCAAAGCACTGATTATGGGATATTTCAGATCAAT\nAGCCACTATTGGTGTAACAATGGCAGAACCCCAGGAGCAGTTAATGCCTGTCATATATCC\nTGCAATGCTTTGCTGCAAGATGACATCACTGAAGCTGTGGCCTGTGCAAAGAGGGTTGTC\nCGCGATCCACAAGGCATTAGGGCATGGGTGGCATGGAAAGCTCATTGTCAAAACAGAGAT\nGTCAGTCAGTATGTTCAAGGTTGTGGAGTA\n\n\n\nlysozymeSmall.fa.treefile\n\n(Hsa_Human:0.0087447996,Hla_gibbon:0.0130303081,(((Cgu/Can_colobus:0.0156654142,Pne_langur:0.0181835564):0.0280807319,Mmu_rhesus:0.0070703774):0.0147707727,(Ssc_squirrelM:0.0140657314,Cja_marmoset:0.0076397044):0.0477319527):0.0256856586);\n\n系統樹ファイルは IQ-TREE を使って推定したもの。 手元でやってもらってもいいです。\niqtree2 --version\n# IQ-TREE multicore version 2.0.7 for Linux 64-bit built Jan 21 2022\n# Developed by Bui Quang Minh, Nguyen Lam Tung, Olga Chernomor,\n# Heiko Schmidt, Dominik Schrempf, Michael Woodhams.\n\niqtree2 -s lysozymeSmall.fa -m TEST",
    "crumbs": [
      "Bioinformatics",
      "PAML チュートリアル"
    ]
  },
  {
    "objectID": "bio/paml-tutorial.html#素の-paml-を動かす",
    "href": "bio/paml-tutorial.html#素の-paml-を動かす",
    "title": "PAML チュートリアル",
    "section": "素の PAML を動かす",
    "text": "素の PAML を動かす\n\nPAML website\nPAML github リポジトリ\n井上潤さんのホームページ\nPAML Beginner’s Guide\n\n\nPAML をインストールする\nいずれかのパッケージ管理ツールを介するのが楽。\nHomebrew を使う場合 brewsci/bio/ リポジトリのため、 M2 チップ以降の Mac には対応していない可能性がある。 遺伝研では apptainer (singularity) を使わなくてもすでに PAML の環境が整っている。 (c.f. which -a codeml)\n## Homebrew を使う (Mac, M2 チップ以上だと無理かも)\nbrew install brewsci/bio/paml\n\n## apt を使う (Ubuntu)\nsudo apt install paml\n\n## conda を介したインストール (共通)\nconda install -c bioconda paml\n\n## apptainer のやつを使う (遺伝研)\nls /usr/local/biotools/p/paml*\nこれらのいずれの方法も使えないときは、 ソースコードを ダウンロードして手元でビルドする。 方法は公式サイトに記載がある。\n\n\n.ctl ファイルの概要\ncodeml を動かすとき、ファイルの指定や種々のオプションの指定は、 すべてコントロールファイル (.ctl) に記述する。 見た目はこんな感じ:\n\n\nlysozymeSmall.ctl\n\n      seqfile = lysozymeSmall.fa\n     treefile = lysozymeSmall.fa.treefile\n      outfile = your_output_file\n\n        noisy = 9   * 0,1,2,3,9: how much rubbish on the screen\n      verbose = 1   * 1: detailed output, 0: concise output\n      runmode = 0   * 0: user tree;  1: semi-automatic;  2: automatic\n                    * 3: StepwiseAddition; (4,5):PerturbationNNI\n\n      seqtype = 1   * 1:codons; 2:AAs; 3:codons--&gt;AAs\n    CodonFreq = 2   * 0:1/61 each, 1:F1X4, 2:F3X4, 3:codon table\n        clock = 0   * 0: no clock, unrooted tree, 1: clock, rooted tree\n        model = 2\n                    * models for codons:\n                        * 0:one, 1:b, 2:2 or more dN/dS ratios for branches\n\n      NSsites = 0   * dN/dS among sites. 0:no variation, 1:neutral, 2:positive\n        icode = 0   * 0:standard genetic code; 1:mammalian mt; 2-10:see below\n\n    fix_kappa = 0   * 1: kappa fixed, 0: kappa to be estimated\n        kappa = 2   * initial or fixed kappa\n    fix_omega = 0   * 1: omega or omega_1 fixed, 0: estimate\n        omega = 2   * initial or fixed omega, for codons or codon-transltd AAs\n\n    fix_alpha = 1   * 0: estimate gamma shape parameter; 1: fix it at alpha\n        alpha = .0  * initial or fixed alpha, 0:infinity (constant rate)\n       Malpha = 0   * different alphas for genes\n        ncatG = 4   * # of categories in the dG or AdG models of rates\n\n        getSE = 0   * 0: don't want them, 1: want S.E.s of estimates\n RateAncestor = 0   * (1/0): rates (alpha&gt;0) or ancestral states (alpha=0)\n       method = 0   * 0: simultaneous; 1: one branch at a time\n  fix_blength = 0  * 0: ignore, -1: random, 1: initial, 2: fixed, 3: proportional\n\n\n* Specifications for duplicating results for the small data set in table 1\n* of Yang (1998 MBE 15:568-573).\n* see the tree file lysozyme.trees for specification of node (branch) labels\n\nどの解析でも共通で変更するのは seqfile, treefile, outfile の3つ。 model, NSsites, fix_omega, omega は解析に応じて変更する。\n\nseqfile\n\nDNAまたはタンパク質の配列のファイルパス。\n\ntreefile\n\n系統樹のファイルパス。tip名は seqfile のものと一致している必要がある。\n\noutfile\n\n出力ファイルのパス。\n\nmodel\n\n系統樹の各 branch における \\(\\omega = d_\\text{N} / d_\\text{S}\\) の設定。\n\n\n0: 系統樹全体で均一の \\(\\omega = d_\\text{N} / d_\\text{S}\\) を推定。\n\n\n1: branch ごとに異なる \\(\\omega = d_\\text{N} / d_\\text{S}\\) を推定。\n\n\n2: treefile の branch に #, #1 などの記号を振って各記号の branch で異なる \\(\\omega = d_\\text{N} / d_\\text{S}\\) を推定。\n\nNSsites\n\nコドン/アミノ酸サイトごとの \\(\\omega = d_\\text{N} / d_\\text{S}\\) の設定。\n\n\n0: サイト間で \\(\\omega = d_\\text{N} / d_\\text{S}\\) が同じと仮定。branchモデルの時はこれ。\n\n\n1: Neutral\n\n\n2: Positive\n\nfix_omega\n\n\\(\\omega = d_\\text{N} / d_\\text{S}\\) を固定するかどうか。\n\n\n0: 初期値から最尤推定する。\n\n\n1: 初期値で固定する。\n\nomega\n\n\\(\\omega = d_\\text{N} / d_\\text{S}\\) の初期値。\n\n\n\n\nおおまかな流れ\n検証したいシナリオ (特定の枝で正の自然選択がある、等) を対立仮説、 そうでないと仮定するシナリオを帰無仮説としてそれぞれ .ctl を書いて codeml を動かす。\nそれぞれの仮説のパラメータ数と対数尤度が得られるので、 尤度比検定を用いて帰無仮説を棄却することで対立仮説を採択する。\nよく使われる対立仮説と帰無仮説の組み合わせは以下の表のとおり:\n\n\n\n対立仮説\n帰無仮説\n検定すること\n引用\n\n\n\n\nM2\nM1\n特定サイトにおける正の自然選択\nYang 2000\n\n\nM3\nM0\nサイト間でdN/dSが異なるか\n〃\n\n\nM8\nM7\n特定サイトにおける正の自然選択\nYang 2000\n\n\nM8\nM8a\n特定サイトにおける選択の緩和\n〃\n\n\nbsA\nbsA1\n特定の枝の特定のサイトにおける正の自然選択\nZhang 2005\n\n\nbsA\nM1\n特定の枝の特定のサイトにおける選択の緩和\nZhang 2005\n\n\nbsC\nM1\n特定のクレードの特定のサイトでdN/dSが異なるか\nYang 2002\n\n\nbsD\nM3\n特定のクレードの特定のサイトでdN/dSが異なるか\nYang 2002, Bielawski 2004\n\n\nb_free\nb_neut\n特定の枝でdN/dSが1と異なるか\nYang 2002\n\n\nb_free\nM0\n特定の枝でdN/dSが他と異なるか\nYang 2002\n\n\n\n\n\nSite モデル\n\n\nBranch モデル\n\n\nBranch-Site モデル",
    "crumbs": [
      "Bioinformatics",
      "PAML チュートリアル"
    ]
  },
  {
    "objectID": "bio/paml-tutorial.html#ete-を使って-paml-を動かす",
    "href": "bio/paml-tutorial.html#ete-を使って-paml-を動かす",
    "title": "PAML チュートリアル",
    "section": "ete を使って PAML を動かす",
    "text": "ete を使って PAML を動かす\n🚧 作成中 🚧",
    "crumbs": [
      "Bioinformatics",
      "PAML チュートリアル"
    ]
  }
]