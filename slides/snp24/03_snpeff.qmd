---
title: "Part. 3 SnpEff ã«ã‚ˆã‚‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³"
subtitle: "å…¨ã‚²ãƒãƒ è§£æãƒãƒ³ã‚ºã‚ªãƒ³ 2024 æ–°æ‘ã‚°ãƒ«ãƒ¼ãƒ—<br>&mdash;ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ç†è§£ã™ã‚‹ SNP è§£æã®æµã‚Œ"
author: "ç•œç”£ç ” åšå£«1å¹´&emsp;æ¾ç”° å„ªæ¨¹"
format: revealjs
revealjs-plugins:
  - pointer
highlight-style: github
---


## Part. 3 SnpEff ã«ã‚ˆã‚‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

**ç›®æ¨™**

1. å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸ SNP è§£æãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
2. ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã¨è§£æã®æµã‚Œã«ã¤ã„ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã€‚

<hr style="margin-block: 20px;">

**ã‚³ãƒ³ãƒ†ãƒ³ãƒ„**

- <span style="color: #DDD;">åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³æ“ä½œ</span>
- <span style="color: #DDD;">NGS å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—</span>
- <span style="color: #DDD;">ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</span>
- <span style="color: #DDD;">ãƒªãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°</span>
- <span style="color: #DDD;">ãƒãƒªã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ«</span>
- SNP ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³


## SnpEff ã‚’ç”¨ã„ãŸå¤‰ç•°ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

éºä¼å­ã®ä½ç½®æƒ…å ± (GTF/GFF) ã‚’å‚ç…§ã—ã¦ã€
"**ã“ã® SNP ã¯ XX éºä¼å­ä¸Šã®å¤‰ç•°ã§ã€ã—ã‹ã‚‚ã‚¢ãƒŸãƒé…¸ã‚’å¤‰ãˆã‚‹**"
ã¿ãŸã„ãªæƒ…å ±ã‚’ä»˜åŠ ã™ã‚‹ã€‚

![](./images/snp_annotation.png){width="900"}


## SnpEff å®Ÿè¡Œç’°å¢ƒã®æ§‹ç¯‰ (ã®ãŸã‚ã® Java ç’°å¢ƒæ§‹ç¯‰)

<small>
<https://pcingola.github.io/SnpEff/download/>
</small>

SnpEff ã¯ Java ã¨ã„ã†ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ä¾å­˜ã—ã¦ã„ã‚‹ã€‚
éºä¼ç ”ã® Java ã¯ã¡ã‚‡ã£ã¨å¤ã„ã®ã§ã€
[æœ€æ–°ç‰ˆã® Java ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](https://www.oracle.com/java/technologies/downloads/?er=221886)
ã™ã‚‹:

```sh
mkdir ~/bin
cd ~/bin
wget https://download.oracle.com/java/23/latest/jdk-23_linux-x64_bin.tar.gz
tar zxvf jdk-23_linux-x64_bin.tar.gz
# rm jdk-23_linux-x64_bin.tar.gz
```


## SnpEff å®Ÿè¡Œç’°å¢ƒã®æ§‹ç¯‰ (ã®ãŸã‚ã® Java ç’°å¢ƒæ§‹ç¯‰)

Java ã‚³ãƒãƒ³ãƒ‰ã‚’ã©ã“ã§ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ (PATH ã‚’é€šã™ã€‚)

ãƒ›ãƒ¼ãƒ ã«æˆ»ã£ã¦ã€`.bash_profile` (ã‚‚ã—ãã¯ `.bashrc`) ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

```Sh
cd
ls -a
```

ã©ã¡ã‚‰ã‹ã‚’é–‹ã„ã¦ã€ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã—ã¦ä¿å­˜ã™ã‚‹:

```sh
export JAVA_HOME=${HOME}/bin/jdk-23  # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚‚ã®ã«åˆã‚ã›ã‚‹ã€‚jdk23-1 ãªã‚‰ ${HOME}/bin/jdk23-1 ã¨æ›¸ãã€‚
export PATH=${JAVA_HOME}/bin:$PATH
export MALLOC_ARENA_MAX=2
```

ç·¨é›†ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã€Java ã®å‹•ä½œç¢ºèªã‚’ã™ã‚‹:

```sh
source .bash_profile
java -version
```


## SnpEff å®Ÿè¡Œç’°å¢ƒã®æ§‹ç¯‰

æœ€æ–°ç‰ˆã® SnpEff ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹:

```sh
cd ~/bin
wget https://snpeff.blob.core.windows.net/versions/snpEff_latest_core.zip
unzip snpEff_latest_core.zip
# rm snpEff_latest_core.zip
```

å…ˆã»ã©ã¨åŒã˜ã‚ˆã†ã« SnpEff ã® PATH ã‚’é€šã™ã€‚
ãƒ›ãƒ¼ãƒ ã® `.bash_profile` ã‹ `.bashrc` ã‚’é–‹ã„ã¦ä»¥ä¸‹ã®è¡Œã‚’è¿½åŠ ã™ã‚‹:

```sh
export PATH=${HOME}/bin/snpEff/scripts:$PATH
```

SnpEff ã®å‹•ä½œç¢ºèªã‚’ã™ã‚‹:

```sh
snpEff -version
```


## SnpEff ã«ã‚ˆã‚‹å¤‰ç•°ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

SnpEff ã¯æ—¢å­˜ã®éºä¼å­æƒ…å ±ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚Šã€
æ‰‹å…ƒã® GTF/GFF ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è‡ªä½œã—ãŸã‚Šã—ã¦ä½¿ã†ã€‚

Escherichia_coli_b_str_rel606 ã®éºä¼å­æƒ…å ±ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:

```sh
cd ~/snp24  # ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸æˆ»ã‚‹ã®ã‚’å¿˜ã‚Œãšã«
snpEff download -v Escherichia_coli_b_str_rel606
```

å¤‰ç•°ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³:

```sh
snpEff Escherichia_coli_b_str_rel606 hq_SRR030257.vcf > hq_SRR030257_snpeff.vcf
```


## SnpEff ã®çµæœ (VCF)

```sh
less hq_SRR030257_snpeff.vcf
```

é•·ãã¦è¦‹ã¥ã‚‰ã„ãŒã€INFO ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«æ–°ãŸã«
`ANN=` ã«ç¶šãå½¢ã§ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³çµæœãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚

ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³çµæœã¯ `|` åŒºåˆ‡ã‚Šã®16é …ç›®ã‹ã‚‰ãªã‚‹ã€‚
è¤‡æ•°ã®éºä¼å­ã«ã¾ãŸãŒã‚‹å ´åˆã¯ã•ã‚‰ã« `,` åŒºåˆ‡ã‚Šã§ç¶šãã€‚

ä¾‹:

```txt
G|missense_variant|MODERATE|pcnB|ECB_00142|transcript|ACT37835|protein_coding|1/1|c.904A>C|p.Asn302His|904/1365|904/1365|302/454||WARNING_TRANSCRIPT_NO_START_CODON
# ALTã‚¢ãƒªãƒ«|å¤‰ç•°ã®ç¨®é¡|å¤‰ç•°ã®å½±éŸ¿|éºä¼å­å|éºä¼å­ID|ã‚¿ã‚¤ãƒ—|è»¢å†™ç”£ç‰©å|è»¢å†™ç”£ç‰©biotype|Rank/total|å¡©åŸºã®ä½ç½®ã¨å¤‰ç•°|ã‚¢ãƒŸãƒé…¸ã®ä½ç½®ã¨å¤‰ç•°|cDNA_position/cDNA_length|CDS_position/CDS_length|Protein_position/Protein_length|Distance to feature|ã‚¨ãƒ©ãƒ¼ã‚„è­¦å‘Š
```

*pcnB* ã®ã‚¢ãƒŸãƒé…¸ã‚’å¤‰ãˆã‚‹å¤‰ç•°ã€302ç•ªç›®ã®ã‚¢ã‚¹ãƒ‘ãƒ©ã‚®ãƒ³ãŒãƒ’ã‚¹ãƒã‚¸ãƒ³ã«ãªã£ã¦ã„ã‚‹ã€‚


## SnpEff ã®çµæœ (genes)

SnpEff ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`snpEff_genes.txt` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã§ãã‚‹ã€‚

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯å„è»¢å†™ç”£ç‰©ã”ã¨ã«ã€ã©ã®ç¨‹åº¦ã®å½±éŸ¿ã®å¤‰ç•°ãŒã„ãã¤ã‚ã‚‹ã‹ãŒã‚¿ãƒ–åŒºåˆ‡ã‚Šã§æ•´ç†ã•ã‚Œã¦ã„ã‚‹ã€‚

ã‚¢ãƒŸãƒé…¸ã‚’å¤‰ãˆã‚‹å¤‰ç•°ã‚’ã¨ã‚‚ãªã†éºä¼å­ã‚’æŠœãå‡ºã—ã¦ã¿ã‚‹:

```sh
cat snpEff_genes.txt | awk 'NR>1 { if ($11 >= 1) { print $0 } }'
```

ğŸ”° å…ƒè«–æ–‡ [Barrick et al. 2009](https://doi.org/10.1038/nature08480) ã®
[Table. 1](https://www.nature.com/articles/nature08480/tables/1) ã¨æ¯”ã¹ã¦ã¿ã‚ˆã†ã€‚


## ãƒ‹ãƒ¯ãƒˆãƒªã§ SnpEff ã‚’å‹•ã‹ã™å ´åˆ

ç”Ÿç‰©ç¨®/ã‚²ãƒãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒãªã„å ´åˆã‚‚ã‚ã‚‹:

```sh
snpEff databases | grep Gallus
# GRCg6a.99  Gallus_gallus
# Galgal4.75  Gallus_gallus
```

ãƒ‹ãƒ¯ãƒˆãƒªã‚‚ GRCg7b ã‚’ä½¿ã†å ´åˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è‡ªä½œã™ã‚‹å¿…è¦ãŒã‚ã‚‹:

ã‚„ã‚Šæ–¹
: <https://pcingola.github.io/SnpEff/snpeff/build_db/>
: <https://ymat2.github.io/bio/snpEff.html>


## Part. 3 ã¾ã¨ã‚

**é”æˆğŸ‰**

- [ ] SnpEff ã‚’ä½¿ã£ã¦ SNP ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

<br>

**å‚è€ƒ**

- [SnpEff å…¬å¼ã‚µã‚¤ãƒˆ](https://pcingola.github.io/SnpEff/snpeff/introduction/)


## ä»Šæ—¥ã®ã¾ã¨ã‚

**é”æˆğŸ‰**

- [ ] å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸ SNP è§£æãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
- [ ] ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã¨è§£æã®æµã‚Œã«ã¤ã„ã¦ç†è§£ãŒæ·±ã¾ã£ãŸã€‚

<hr style="margin-block: 20px;">

**ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨**

- åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³æ“ä½œ
- NGS å…¬é–‹ãƒ‡ãƒ¼ã‚¿ã®å–å¾—
- ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
- ãƒªãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°
- ãƒãƒªã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ«
- SNP ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

<style>
.button a {
    background: #eee;
    border-radius: 9999px;
    position: relative;
    display: flex;
    justify-content: space-around;
    align-items: center;
    margin: 0 auto;
    max-width: 250px;
    padding: 5px 10px;
    color: #333333;
    line-height: 1.8;
    text-decoration: none;
    transition: 0.3s ease-in-out;
    font-weight: 500;
}
.button a:hover {
    background: #333333;
    color: #FFF;
}
.button a:after {
    content: '';
    width: 5px;
    height: 5px;
    border-top: 3px solid #333333;
    border-right: 3px solid #333333;
    transform: rotate(45deg) translateY(-50%);
    position: absolute;
    top: 50%;
    right: 20px;
    border-radius: 1px;
    transition: 0.3s ease-in-out;
}
.button a:hover:after {
    border-color: #FFF;
}
</style>

<div class="button">
  [Top ã¸æˆ»ã‚‹](./index.qmd)
</div>
